# 云数据库MongoDB版监控 {#concept_bwg_gx4_ydb .concept}

云监控通过监控云数据库MongoDB版服务实例的CPU使用率、内存使用率等多个监控项，帮助您监测实例的运行状态，并支持您对监控项设置报警规则。在您购买MongoDB服务后，云监控会自动对上述监控项收集数据。

## 监控服务 {#section_xjm_3x4_ydb .section}

-   **监控项说明**

    |监控项|含义|维度|单位|最小监控粒度|
    |:--|:-|:-|:-|:-----|
    |CPU使用率|实例的CPU使用率|用户维度、实例维度、主备维度|百分比|5分钟|
    |内存使用率|实例的内存使用率|用户维度、实例维度、主备维度|百分比|5分钟|
    |磁盘使用率|实例的磁盘使用率|用户维度、实例维度、主备维度|百分比|5分钟|
    |IOPS使用率|实例的IOPS使用率|用户维度、实例维度、主备维度|百分比|5分钟|
    |连接数使用率|连接数是指应用程序可以连接到MongoDB实例的数量。连接数使用率即已经使用的连接数百分率|用户维度、实例维度、主备维度|百分比|5分钟|
    |平均每秒SQL查询数|MongoDB实例的平均每秒SQL查询数|用户维度、实例维度、主备维度|个数|5分钟|
    |连接数使用量|当前应用程序连接到MongoDB实例的数量|用户维度、实例维度、主备维度|个数|5分钟|
    |实例占用磁盘空间量|实例实际使用的磁盘空间总量|用户维度、实例维度、主备维度|字节|5分钟|
    |数据占用磁盘空间量|数据占用的磁盘空间容量|用户维度、实例维度、主备维度|字节|5分钟|
    |日志占用磁盘空间量|日志占用的磁盘空间容量|用户维度、实例维度、主备维度|字节|5分钟|
    |内网入流量|实例的网络流入流量|用户维度、实例维度、主备维度|字节|5分钟|
    |内网出流量|实例的网络流出流量|用户维度、实例维度、主备维度|字节|5分钟|
    |请求数|发送到服务端的请求总量|用户维度、实例维度、主备维度|个数|5分钟|
    |Insert操作次数|从MongoDB实例最近一次启动到现在累计接收到的insert命令的次数|用户维度、实例维度、主备维度|个数|5分钟|
    |Query操作次数|从MongoDB实例最近一次启动到现在累计接收到的query命令的次数|用户维度、实例维度、主备维度|字节|5分钟|
    |Update操作次数|从MongoDB实例最近一次启动到现在累计接收到的update命令的次数|用户维度、实例维度、主备维度|次数|5分钟|
    |Delete操作次数|从MongoDB实例最近一次启动到现在累计执行delete的操作次数|用户维度、实例维度、主备维度|次数|5分钟|
    |Getmore操作次数|从MongoDB实例最近一次启动到现在累计执行getmore的操作次数|用户维度、实例维度、主备维度|次数|5分钟|
    |Command操作次数|从MongoDB实例最近一次启动到现在向数据库发出的command的累计次数|用户维度、实例维度、主备维度|次数|5分钟|
    |实例故障|事件类型指标，可设置报警规则|-|-|-|

    **说明：** 

    -   监控数据最多保存31天。
    -   最多可连续查看14天的监控数据。

-   **查看监控数据**
    1.  登录[云监控控制台](https://cms-intl.console.aliyun.com)。
    2.  单击左侧导航栏中**云服务监控**下的**云数据库MongoDB版**，进入MongoDB监控列表页面。
    3.  单击实例名称或**操作**中的**监控图表**即可进入实例监控图表页面，查看各项指标。
    4.  单击页面上方的**时间范围**快速选择按钮或自定义时间范围图标，监控数据最长支持查看连续 14 天的监控数据。
    5.  （可选）单击监控图右上角的放大按钮，可查看监控大图。

## 报警服务 {#section_cpf_3qp_ydb .section}

-   **设置单条报警规则**
    1.  登录[云监控控制台](https://cms-intl.console.aliyun.com)。
    2.  单击左侧导航栏中**云服务监控**下的**云数据库MongoDB版**，进入MongoDB监控列表页面。
    3.  单击实例名称或**操作**中的**监控图表**，进入实例的监控图表页面。
    4.  单击监控图右上角的铃铛图标，可对该实例对应的监控项设置报警规则。

-   **设置批量报警规则**
    1.  登录[云监控控制台](https://cms-intl.console.aliyun.com)。
    2.  单击左侧导航栏中**云服务监控**下的**云数据库MongoDB版**，进入MongoDB监控列表页面。
    3.  选中所需实例后，单击列表下方的**设置报警规则**按钮，即可批量添加报警规则。
-   **参数说明**
    -   产品：例如云服务器ECS、RDS、OSS 等。
    -   资源范围：报警规则的作用范围，分为全部资源、实例。
        -   全部资源：表示该规则作用在用户名下对应产品的全部实例上。例如设置了全部资源粒度的MongoDB CPU使用率大于80%报警，则只要用户名下有MongoDB CPU使用率大于80%，就会发送报警通知。资源范围选择全部资源时，报警的资源最多1000个，超过1000个可能会导致达到阈值不报警的问题，建议您使用应用分组按业务划分资源后再设置报警。
        -   实例：表示该规则只作用在某个具体实例上。例如设置了实例粒度的主机 CPU 使用率大于80%报警，则只要这个实例 CPU使用率大于80% ，就会发送报警通知。
    -   规则名称：报警规则的名称。
    -   规则描述：报警规则的主体，定义在监控数据满足何种条件时，触发报警规则。例如规则描述为CPU使用率5分钟平均值\>=90%，则报警服务会5分钟检查一次5分钟内的数据是否满足平均值\>=90%。

        **报警规则举例说明**：以主机监控为例，单个服务器监控指标15秒上报一个数据点，5分钟有20个数据点。

        -   CPU使用率5分钟平均值\>90%， 含义是CPU使用率 5分钟的20个数据点平均值大于90%。
        -   CPU使用率5分钟总是\>90%， 含义是CPU使用率 5分钟的20个数据点全部大于90%。
        -   CPU使用率5分钟只要有一次\>90%，含义是CPU使用率 5分钟的20个数据点至少有1个大于90%。
        -   公网流出流量5分钟总计\>50M ，含义是公网流出流量5分钟的20个数据点求和结果大于50M。
    -   通道沉默时间：指报警发生后如果未恢复正常，间隔多久重复发送一次报警通知。
    -   连续几次超过阈值后报警：连续几次报警的探测结果符合您设置的规则描述，才会触发报警。例如规则描述为“CPU使用率 1分钟内平均值\>80%,连续3次超过阈值后报警”，则连续出现3次 CPU使用率 1分钟内平均值\>80%的情况，才会触发报警。
    -   生效时间：报警规则的生效时间，报警规则只在生效时间内才会检查监控数据是否需要报警。
    -   通知对象：发送报警的联系人组。
    -   报警级别：
        -   邮件+钉钉机器人
    -   邮件主题：默认为产品名称+监控项名称+实例ID。
    -   邮件备注：自定义报警邮件补充信息。填写邮件备注后，发送报警的邮件通知中会附带您的备注。
    -   报警回调：填写公网可访问的URL，云监控会将报警信息通过POST请求推送到该地址，目前仅支持HTTP协议。

